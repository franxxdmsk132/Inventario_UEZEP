<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>


    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
          crossorigin="anonymous">
    <style>
        .btn:hover {
            transform: scale(1.2); /* Aumenta el tamaño del botón al 120% cuando se pasa el cursor sobre él */
            transition: transform 0.2s; /* Agrega una transición suave de 0.2 segundos */
        }

        .thead-darkGray {
            background-color: #4b4c4f; /* Puedes ajustar el color según tus preferencias */
            color: white;
        }

        .body-gradient {
            background: linear-gradient(to bottom, #ffffff, #4b4c4f 1800px)

        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            width: 100%;
            height: 100%;
            min-height: 100%;
            overflow-x: hidden;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        nav {
            background-color: #4b4c4f;
            color: white;
            padding: 10px;
            text-align: center;
        }

        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        nav li {
            display: inline;
            margin-right: 20px;
        }

        nav a {
            text-decoration: none;
            color: white;
            font-weight: bold;
        }

        .nav-link:hover {
            transform: scale(1.25); /* Aumenta el tamaño del enlace al 120% cuando se pasa el cursor sobre él */
            transition: transform 0.2s; /* Agrega una transición suave de 0.2 segundos */
            color: #ffffff; /* Cambia el color del texto del enlace a rojo cuando el puntero se acerca */

        }

        .fila-inactiva {
            background-color: rgba(230, 155, 155, 0.29); /* Cambia el color de fondo a rojo claro */
        }


    </style>
    <title>Asignacion de Muebles</title>

</head>

<body class="body-gradient">
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="text-center">
                <br>
                <h3>
                    <img th:src="@{/images/Logo-NBG.png}" class="d-inline-block align-text-top" width="40" height="40"
                         alt="icon">
                    <b>Mobiliario de Aulas</b>
                </h3>
                <h4><a th:href="@{/defmub/lista}" class="btn btn-warning btn-sm mb-3 d-inline-block align-text-top">ATRAS</a></h4>
                <hr>
                <h2>Asignar Muebles en una Aula</h2>
            </div>
            <form action="/defmub/save2" method="post" th:object="${asignacionForm}"
                  class="d-flex flex-column align-items-center">
                <!-- Select de aulas -->
                <div class="form-group">
                    <label for="id_aula" class="h4">Selecciona un Aula:</label>
                    <select id="id_aula" name="id_aula" class="form-control" required>
                        <option value="" disabled selected>Selecciona un aula</option>
                        <!-- Iterar sobre la lista de aulas disponibles -->
                        <option th:each="aula : ${allAulas}" th:value="${aula.id_aula}"
                                th:text="${aula.curso + ' - ' + aula.paralelo}"></option>
                    </select>
                </div>

                <!-- Lista de muebles -->
                <div class="form-group">
                    <label class="h4">Selecciona los Muebles:</label>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <table class="table">
                                    <tbody>
                                    <!-- Iterar sobre la mitad de la lista de muebles disponibles -->
                                    <tr th:each="mueble, i: ${allMuebles}" th:if="${i.index % 2 == 0}">
                                        <td>
                                            <div class="form-check">
                                                <input type="checkbox" name="id_mueble" th:value="${mueble.id_mueble}"
                                                       class="form-check-input" onclick="habilitarCantidad(this)">
                                                <label th:for="${'mueble' + mueble.id_mueble}"
                                                       class="form-check-label h5"
                                                       th:text="${mueble.codigo_mueble + ' - ' + mueble.nombre_mueble }"></label>
                                            </div>
                                        </td>
                                        <td>
                                            <input type="number" name="cantidad" class="form-control cantidad"
                                                   placeholder="Cantidad" disabled>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <table class="table">
                                    <tbody>
                                    <!-- Iterar sobre la otra mitad de la lista de muebles disponibles -->
                                    <tr th:each="mueble, i: ${allMuebles}" th:if="${i.index % 2 == 1}">
                                        <td>
                                            <div class="form-check">
                                                <input type="checkbox" name="id_mueble" th:value="${mueble.id_mueble}"
                                                       class="form-check-input" onclick="habilitarCantidad(this)">
                                                <label th:for="${'mueble' + mueble.id_mueble}"
                                                       class="form-check-label h5"
                                                       th:text="${mueble.codigo_mueble + ' - ' + mueble.nombre_mueble }"></label>
                                            </div>
                                        </td>
                                        <td>
                                            <input type="number" name="cantidad" class="form-control cantidad"
                                                   placeholder="Cantidad" disabled>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">Asignar Muebles</button>
            </form>
            <br>
        </div>
    </div>
</div>
</body>
<script>
    function habilitarCantidad(checkbox) {
        // Obtener el campo de cantidad asociado al checkbox actual
        var cantidadInput = checkbox.parentElement.parentElement.nextElementSibling.querySelector('input[name="cantidad"]');
        // Habilitar o deshabilitar el campo de cantidad según el estado del checkbox
        cantidadInput.disabled = !checkbox.checked;
    }

</script>
<script>
    // Función para manejar la selección de muebles
    function handleSelection() {
        var selectElement = document.getElementById("idMuebles");
        var selectedMuebles = [];

        // Reiniciar la lista de muebles seleccionados
        document.getElementById("selectedMuebles").innerHTML = "";

        // Obtener todos los muebles seleccionados
        for (var i = 0; i < selectElement.selectedOptions.length; i++) {
            var selectedOption = selectElement.selectedOptions[i];
            var selectedMuebleId = selectedOption.value;
            var selectedMuebleName = selectedOption.text;

            selectedMuebles.push(selectedMuebleId);

            // Mostrar los muebles seleccionados
            var selectedMueblesLabel = document.getElementById("selectedMuebles");
            selectedMueblesLabel.innerHTML += "<span>" + selectedMuebleName + "</span>, ";
        }

        // Actualizar el valor del campo de texto oculto
        var hiddenInput = document.getElementById("selectedMueblesIds");
        hiddenInput.value = selectedMuebles.join(",");
    }
</script>
<script>
    function validarFormulario() {
        // Obtener todos los campos de cantidad
        var cantidades = document.getElementsByName("cantidad");

        // Iterar sobre los campos de cantidad
        for (var i = 0; i < cantidades.length; i++) {
            // Si algún campo de cantidad está vacío y su correspondiente checkbox está marcado, mostrar un mensaje de error y detener el envío del formulario
            if (cantidades[i].value === "" && cantidades[i].previousElementSibling.checked) {
                alert("Por favor, ingresa la cantidad para todos los muebles seleccionados.");
                return false; // Detener el envío del formulario
            }
        }
        return true; // Permitir el envío del formulario si todas las validaciones pasan
    }
</script>
</html>
